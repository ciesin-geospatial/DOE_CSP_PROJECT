"""
Simulating desalination with wrapper from SAM & PSA models for MED
Created by: Vikas Vicraman
Create date: 11/14/2018
V1:
Modified by: Vikas Vicraman
Modified date: 11/14/2018
"""
#import Model_MED_PSA as model
from SAM.PySSC import PySSC

class samCspPhysical:
    ssc = PySSC()
    print ('Current folder = D:/Columbia/Thesis/SAMProjects/Integration')
    print ('SSC Version = ', ssc.version())
    ssc = PySSC()
    print ('SSC Build Information = ', ssc.build_info().decode("utf - 8"))
    ssc.module_exec_set_print(0)
    data = ssc.data_create()
    ssc.data_set_string( data, b'file_name', b'C:/SAM/2017.9.5/solar_resource/United Arab Emirates ARE Abu_Dhabi (INTL).csv');
    ssc.data_set_number( data, b'track_mode', 1 )
    ssc.data_set_number( data, b'tilt', 0 )
    ssc.data_set_number( data, b'azimuth', 0 )
    ssc.data_set_number( data, b'system_capacity', 50000.0390625 )
    ssc.data_set_number( data, b'nSCA', 8 )
    ssc.data_set_number( data, b'nHCEt', 4 )
    ssc.data_set_number( data, b'nColt', 4 )
    ssc.data_set_number( data, b'nHCEVar', 4 )
    ssc.data_set_number( data, b'nLoops', 106 )
    ssc.data_set_number( data, b'eta_pump', 0.85000002384185791 )
    ssc.data_set_number( data, b'HDR_rough', 4.5699998736381531e-05 )
    ssc.data_set_number( data, b'theta_stow', 170 )
    ssc.data_set_number( data, b'theta_dep', 10 )
    ssc.data_set_number( data, b'Row_Distance', 15 )
    ssc.data_set_number( data, b'FieldConfig', 2 )
    ssc.data_set_number( data, b'T_startup', 300 )
    ssc.data_set_number( data, b'P_ref', 55.555599212646484 )
    ssc.data_set_number( data, b'm_dot_htfmin', 1 )
    ssc.data_set_number( data, b'm_dot_htfmax', 12 )
    ssc.data_set_number( data, b'T_loop_in_des', 293 )
    ssc.data_set_number( data, b'T_loop_out', 391 )
    ssc.data_set_number( data, b'Fluid', 21 )
    ssc.data_set_number( data, b'T_fp', 150 )
    ssc.data_set_number( data, b'I_bn_des', 950 )
    ssc.data_set_number( data, b'V_hdr_max', 3 )
    ssc.data_set_number( data, b'V_hdr_min', 2 )
    ssc.data_set_number( data, b'Pipe_hl_coef', 0.44999998807907104 )
    ssc.data_set_number( data, b'SCA_drives_elec', 125 )
    ssc.data_set_number( data, b'fthrok', 1 )
    ssc.data_set_number( data, b'fthrctrl', 2 )
    ssc.data_set_number( data, b'water_usage_per_wash', 0.69999998807907104 )
    ssc.data_set_number( data, b'washing_frequency', 63 )
    ssc.data_set_number( data, b'accept_mode', 0 )
    ssc.data_set_number( data, b'accept_init', 0 )
    ssc.data_set_number( data, b'accept_loc', 1 )
    ssc.data_set_number( data, b'solar_mult', 2 )
    ssc.data_set_number( data, b'mc_bal_hot', 0.20000000298023224 )
    ssc.data_set_number( data, b'mc_bal_cold', 0.20000000298023224 )
    ssc.data_set_number( data, b'mc_bal_sca', 4.5 )
    W_aperture =[ 5.75, 6, 6, 6 ];
    ssc.data_set_array( data, b'W_aperture',  W_aperture);
    A_aperture =[ 545, 656, 656, 656 ];
    ssc.data_set_array( data, b'A_aperture',  A_aperture);
    TrackingError =[ 0.99000000953674316, 0.98799997568130493, 0.98799997568130493, 0.98799997568130493 ];
    ssc.data_set_array( data, b'TrackingError',  TrackingError);
    GeomEffects =[ 0.98000001907348633, 0.95200002193450928, 0.95200002193450928, 0.95200002193450928 ];
    ssc.data_set_array( data, b'GeomEffects',  GeomEffects);
    Rho_mirror_clean =[ 0.93500000238418579, 0.93000000715255737, 0.93000000715255737, 0.93000000715255737 ];
    ssc.data_set_array( data, b'Rho_mirror_clean',  Rho_mirror_clean);
    Dirt_mirror =[ 0.97000002861022949, 0.97000002861022949, 0.97000002861022949, 0.97000002861022949 ];
    ssc.data_set_array( data, b'Dirt_mirror',  Dirt_mirror);
    Error =[ 0.99000000953674316, 1, 1, 1 ];
    ssc.data_set_array( data, b'Error',  Error);
    Ave_Focal_Length =[ 2.1099998950958252, 2.1500000953674316, 2.1500000953674316, 2.1500000953674316 ];
    ssc.data_set_array( data, b'Ave_Focal_Length',  Ave_Focal_Length);
    L_SCA =[ 100, 115, 115, 115 ];
    ssc.data_set_array( data, b'L_SCA',  L_SCA);
    L_aperture =[ 8.3333330154418945, 14.375, 14.375, 14.375 ];
    ssc.data_set_array( data, b'L_aperture',  L_aperture);
    ColperSCA =[ 12, 8, 8, 8 ];
    ssc.data_set_array( data, b'ColperSCA',  ColperSCA);
    Distance_SCA =[ 1, 1, 1, 1 ];
    ssc.data_set_array( data, b'Distance_SCA',  Distance_SCA);
    IAM_matrix = [[ 1,   0.050599999725818634,   -0.17630000412464142,   0 ], [ 1,   0.032699998468160629,   -0.13510000705718994,   0 ], [ 1,   0.032699998468160629,   -0.13510000705718994,   0 ], [ 1,   0.032699998468160629,   -0.13510000705718994,   0 ]];
    ssc.data_set_matrix( data, b'IAM_matrix', IAM_matrix );
    HCE_FieldFrac = [[ 0.98500001430511475,   0.0099999997764825821,   0.004999999888241291,   0 ], [ 1,   0,   0,   0 ], [ 1,   0,   0,   0 ], [ 1,   0,   0,   0 ]];
    ssc.data_set_matrix( data, b'HCE_FieldFrac', HCE_FieldFrac );
    D_2 = [[ 0.075999997556209564,   0.075999997556209564,   0.075999997556209564,   0.075999997556209564 ], [ 0.075999997556209564,   0.075999997556209564,   0.075999997556209564,   0.075999997556209564 ], [ 0.075999997556209564,   0.075999997556209564,   0.075999997556209564,   0.075999997556209564 ], [ 0.075999997556209564,   0.075999997556209564,   0.075999997556209564,   0.075999997556209564 ]];
    ssc.data_set_matrix( data, b'D_2', D_2 );
    D_3 = [[ 0.079999998211860657,   0.079999998211860657,   0.079999998211860657,   0.079999998211860657 ], [ 0.079999998211860657,   0.079999998211860657,   0.079999998211860657,   0.079999998211860657 ], [ 0.079999998211860657,   0.079999998211860657,   0.079999998211860657,   0.079999998211860657 ], [ 0.079999998211860657,   0.079999998211860657,   0.079999998211860657,   0.079999998211860657 ]];
    ssc.data_set_matrix( data, b'D_3', D_3 );
    D_4 = [[ 0.11500000208616257,   0.11500000208616257,   0.11500000208616257,   0.11500000208616257 ], [ 0.11500000208616257,   0.11500000208616257,   0.11500000208616257,   0.11500000208616257 ], [ 0.11500000208616257,   0.11500000208616257,   0.11500000208616257,   0.11500000208616257 ], [ 0.11500000208616257,   0.11500000208616257,   0.11500000208616257,   0.11500000208616257 ]];
    ssc.data_set_matrix( data, b'D_4', D_4 );
    D_5 = [[ 0.11999999731779099,   0.11999999731779099,   0.11999999731779099,   0.11999999731779099 ], [ 0.11999999731779099,   0.11999999731779099,   0.11999999731779099,   0.11999999731779099 ], [ 0.11999999731779099,   0.11999999731779099,   0.11999999731779099,   0.11999999731779099 ], [ 0.11999999731779099,   0.11999999731779099,   0.11999999731779099,   0.11999999731779099 ]];
    ssc.data_set_matrix( data, b'D_5', D_5 );
    D_p = [[ 0,   0,   0,   0 ], [ 0,   0,   0,   0 ], [ 0,   0,   0,   0 ], [ 0,   0,   0,   0 ]];
    ssc.data_set_matrix( data, b'D_p', D_p );
    Flow_type = [[ 1,   1,   1,   1 ], [ 1,   1,   1,   1 ], [ 1,   1,   1,   1 ], [ 1,   1,   1,   1 ]];
    ssc.data_set_matrix( data, b'Flow_type', Flow_type );
    Rough = [[ 4.5000000682193786e-05,   4.5000000682193786e-05,   4.5000000682193786e-05,   4.5000000682193786e-05 ], [ 4.5000000682193786e-05,   4.5000000682193786e-05,   4.5000000682193786e-05,   4.5000000682193786e-05 ], [ 4.5000000682193786e-05,   4.5000000682193786e-05,   4.5000000682193786e-05,   4.5000000682193786e-05 ], [ 4.5000000682193786e-05,   4.5000000682193786e-05,   4.5000000682193786e-05,   4.5000000682193786e-05 ]];
    ssc.data_set_matrix( data, b'Rough', Rough );
    alpha_env = [[ 0.019999999552965164,   0.019999999552965164,   0,   0 ], [ 0.019999999552965164,   0.019999999552965164,   0,   0 ], [ 0.019999999552965164,   0.019999999552965164,   0,   0 ], [ 0.019999999552965164,   0.019999999552965164,   0,   0 ]];
    ssc.data_set_matrix( data, b'alpha_env', alpha_env );
    epsilon_3_11 = [[ 100,   0.064000003039836884 ], [ 150,   0.066500000655651093 ], [ 200,   0.070000000298023224 ], [ 250,   0.074500001966953278 ], [ 300,   0.079999998211860657 ], [ 350,   0.086499996483325958 ], [ 400,   0.093999996781349182 ], [ 450,   0.10249999910593033 ], [ 500,   0.1120000034570694 ]];
    ssc.data_set_matrix( data, b'epsilon_3_11', epsilon_3_11 );
    epsilon_3_12 = [[ 0.64999997615814209 ]];
    ssc.data_set_matrix( data, b'epsilon_3_12', epsilon_3_12 );
    epsilon_3_13 = [[ 0.64999997615814209 ]];
    ssc.data_set_matrix( data, b'epsilon_3_13', epsilon_3_13 );
    epsilon_3_14 = [[ 0 ]];
    ssc.data_set_matrix( data, b'epsilon_3_14', epsilon_3_14 );
    epsilon_3_21 = [[ 100,   0.064000003039836884 ], [ 150,   0.066500000655651093 ], [ 200,   0.070000000298023224 ], [ 250,   0.074500001966953278 ], [ 300,   0.079999998211860657 ], [ 350,   0.086499996483325958 ], [ 400,   0.093999996781349182 ], [ 450,   0.10249999910593033 ], [ 500,   0.1120000034570694 ]];
    ssc.data_set_matrix( data, b'epsilon_3_21', epsilon_3_21 );
    epsilon_3_22 = [[ 0.64999997615814209 ]];
    ssc.data_set_matrix( data, b'epsilon_3_22', epsilon_3_22 );
    epsilon_3_23 = [[ 0.64999997615814209 ]];
    ssc.data_set_matrix( data, b'epsilon_3_23', epsilon_3_23 );
    epsilon_3_24 = [[ 0 ]];
    ssc.data_set_matrix( data, b'epsilon_3_24', epsilon_3_24 );
    epsilon_3_31 = [[ 100,   0.064000003039836884 ], [ 150,   0.066500000655651093 ], [ 200,   0.070000000298023224 ], [ 250,   0.074500001966953278 ], [ 300,   0.079999998211860657 ], [ 350,   0.086499996483325958 ], [ 400,   0.093999996781349182 ], [ 450,   0.10249999910593033 ], [ 500,   0.1120000034570694 ]];
    ssc.data_set_matrix( data, b'epsilon_3_31', epsilon_3_31 );
    epsilon_3_32 = [[ 0.64999997615814209 ]];
    ssc.data_set_matrix( data, b'epsilon_3_32', epsilon_3_32 );
    epsilon_3_33 = [[ 0.64999997615814209 ]];
    ssc.data_set_matrix( data, b'epsilon_3_33', epsilon_3_33 );
    epsilon_3_34 = [[ 0 ]];
    ssc.data_set_matrix( data, b'epsilon_3_34', epsilon_3_34 );
    epsilon_3_41 = [[ 100,   0.064000003039836884 ], [ 150,   0.066500000655651093 ], [ 200,   0.070000000298023224 ], [ 250,   0.074500001966953278 ], [ 300,   0.079999998211860657 ], [ 350,   0.086499996483325958 ], [ 400,   0.093999996781349182 ], [ 450,   0.10249999910593033 ], [ 500,   0.1120000034570694 ]];
    ssc.data_set_matrix( data, b'epsilon_3_41', epsilon_3_41 );
    epsilon_3_42 = [[ 0.64999997615814209 ]];
    ssc.data_set_matrix( data, b'epsilon_3_42', epsilon_3_42 );
    epsilon_3_43 = [[ 0.64999997615814209 ]];
    ssc.data_set_matrix( data, b'epsilon_3_43', epsilon_3_43 );
    epsilon_3_44 = [[ 0 ]];
    ssc.data_set_matrix( data, b'epsilon_3_44', epsilon_3_44 );
    alpha_abs = [[ 0.96299999952316284,   0.96299999952316284,   0.80000001192092896,   0 ], [ 0.96299999952316284,   0.96299999952316284,   0.80000001192092896,   0 ], [ 0.96299999952316284,   0.96299999952316284,   0.80000001192092896,   0 ], [ 0.96299999952316284,   0.96299999952316284,   0.80000001192092896,   0 ]];
    ssc.data_set_matrix( data, b'alpha_abs', alpha_abs );
    Tau_envelope = [[ 0.96399998664855957,   0.96399998664855957,   1,   0 ], [ 0.96399998664855957,   0.96399998664855957,   1,   0 ], [ 0.96399998664855957,   0.96399998664855957,   1,   0 ], [ 0.96399998664855957,   0.96399998664855957,   1,   0 ]];
    ssc.data_set_matrix( data, b'Tau_envelope', Tau_envelope );
    EPSILON_4 = [[ 0.86000001430511475,   0.86000001430511475,   1,   0 ], [ 0.86000001430511475,   0.86000001430511475,   1,   0 ], [ 0.86000001430511475,   0.86000001430511475,   1,   0 ], [ 0.86000001430511475,   0.86000001430511475,   1,   0 ]];
    ssc.data_set_matrix( data, b'EPSILON_4', EPSILON_4 );
    EPSILON_5 = [[ 0.86000001430511475,   0.86000001430511475,   1,   0 ], [ 0.86000001430511475,   0.86000001430511475,   1,   0 ], [ 0.86000001430511475,   0.86000001430511475,   1,   0 ], [ 0.86000001430511475,   0.86000001430511475,   1,   0 ]];
    ssc.data_set_matrix( data, b'EPSILON_5', EPSILON_5 );
    GlazingIntactIn = [[ 1,   1,   0,   1 ], [ 1,   1,   0,   1 ], [ 1,   1,   0,   1 ], [ 1,   1,   0,   1 ]];
    ssc.data_set_matrix( data, b'GlazingIntactIn', GlazingIntactIn );
    P_a = [[ 9.9999997473787516e-05,   750,   750,   0 ], [ 9.9999997473787516e-05,   750,   750,   0 ], [ 9.9999997473787516e-05,   750,   750,   0 ], [ 9.9999997473787516e-05,   750,   750,   0 ]];
    ssc.data_set_matrix( data, b'P_a', P_a );
    AnnulusGas = [[ 27,   1,   1,   27 ], [ 27,   1,   1,   27 ], [ 27,   1,   1,   27 ], [ 27,   1,   1,   27 ]];
    ssc.data_set_matrix( data, b'AnnulusGas', AnnulusGas );
    AbsorberMaterial = [[ 1,   1,   1,   1 ], [ 1,   1,   1,   1 ], [ 1,   1,   1,   1 ], [ 1,   1,   1,   1 ]];
    ssc.data_set_matrix( data, b'AbsorberMaterial', AbsorberMaterial );
    Shadowing = [[ 0.93500000238418579,   0.93500000238418579,   0.93500000238418579,   0.96299999952316284 ], [ 0.93500000238418579,   0.93500000238418579,   0.93500000238418579,   0.96299999952316284 ], [ 0.93500000238418579,   0.93500000238418579,   0.93500000238418579,   0.96299999952316284 ], [ 0.93500000238418579,   0.93500000238418579,   0.93500000238418579,   0.96299999952316284 ]];
    ssc.data_set_matrix( data, b'Shadowing', Shadowing );
    Dirt_HCE = [[ 0.98000001907348633,   0.98000001907348633,   1,   0.98000001907348633 ], [ 0.98000001907348633,   0.98000001907348633,   1,   0.98000001907348633 ], [ 0.98000001907348633,   0.98000001907348633,   1,   0.98000001907348633 ], [ 0.98000001907348633,   0.98000001907348633,   1,   0.98000001907348633 ]];
    ssc.data_set_matrix( data, b'Dirt_HCE', Dirt_HCE );
    Design_loss = [[ 190,   1270,   1500,   0 ], [ 190,   1270,   1500,   0 ], [ 190,   1270,   1500,   0 ], [ 190,   1270,   1500,   0 ]];
    ssc.data_set_matrix( data, b'Design_loss', Design_loss );
    SCAInfoArray = [[ 1,   1 ], [ 1,   1 ], [ 1,   1 ], [ 1,   1 ], [ 1,   1 ], [ 1,   1 ], [ 1,   1 ], [ 1,   1 ]];
    ssc.data_set_matrix( data, b'SCAInfoArray', SCAInfoArray );
    SCADefocusArray =[ 8, 7, 6, 5, 4, 3, 2, 1 ];
    ssc.data_set_array( data, b'SCADefocusArray',  SCADefocusArray);
    field_fl_props = [[ 0 ]];
    ssc.data_set_matrix( data, b'field_fl_props', field_fl_props );
    store_fl_props = [[ 1 ]];
    ssc.data_set_matrix( data, b'store_fl_props', store_fl_props );
    ssc.data_set_number( data, b'store_fluid', 18 )
    ssc.data_set_number( data, b'tshours', 6 )
    ssc.data_set_number( data, b'is_hx', 1 )
    ssc.data_set_number( data, b'dt_hot', 5 )
    ssc.data_set_number( data, b'dt_cold', 5 )
    ssc.data_set_number( data, b'hx_config', 2 )
    ssc.data_set_number( data, b'q_max_aux', 156.0550537109375 )
    ssc.data_set_number( data, b'T_set_aux', 391 )
    ssc.data_set_number( data, b'V_tank_hot_ini', 633.24407958984375 )
    ssc.data_set_number( data, b'T_tank_cold_ini', 300 )
    ssc.data_set_number( data, b'vol_tank', 12664.8818359375 )
    ssc.data_set_number( data, b'h_tank', 20 )
    ssc.data_set_number( data, b'h_tank_min', 1 )
    ssc.data_set_number( data, b'u_tank', 0.40000000596046448 )
    ssc.data_set_number( data, b'tank_pairs', 1 )
    ssc.data_set_number( data, b'cold_tank_Thtr', 250 )
    ssc.data_set_number( data, b'hot_tank_Thtr', 365 )
    ssc.data_set_number( data, b'tank_max_heat', 25 )
    ssc.data_set_number( data, b'q_pb_design', 156.0550537109375 )
    ssc.data_set_number( data, b'W_pb_design', 55.555599212646484 )
    ssc.data_set_number( data, b'cycle_max_frac', 1.0499999523162842 )
    ssc.data_set_number( data, b'cycle_cutoff_frac', 0.20000000298023224 )
    ssc.data_set_number( data, b'pb_pump_coef', 0.55000001192092896 )
    ssc.data_set_number( data, b'tes_pump_coef', 0.15000000596046448 )
    ssc.data_set_number( data, b'pb_fixed_par', 0.0054999999701976776 )
    bop_array =[ 0, 1, 0.4830000102519989, 0.51700001955032349, 0 ];
    ssc.data_set_array( data, b'bop_array',  bop_array);
    aux_array =[ 0.02273000031709671, 1, 0.4830000102519989, 0.51700001955032349, 0 ];
    ssc.data_set_array( data, b'aux_array',  aux_array);
    ssc.data_set_number( data, b'fossil_mode', 1 )
    ssc.data_set_number( data, b't_standby_reset', 2 )
    ssc.data_set_number( data, b'sf_type', 1 )
    ssc.data_set_number( data, b'tes_type', 1 )
    tslogic_a =[ 0, 0, 0, 0, 0, 0, 0, 0, 0 ];
    ssc.data_set_array( data, b'tslogic_a',  tslogic_a);
    tslogic_b =[ 0, 0, 0, 0, 0, 0, 0, 0, 0 ];
    ssc.data_set_array( data, b'tslogic_b',  tslogic_b);
    tslogic_c =[ 1.0499999523162842, 1, 1, 1, 1, 1, 1, 1, 1 ];
    ssc.data_set_array( data, b'tslogic_c',  tslogic_c);
    ffrac =[ 0, 0, 0, 0, 0, 0, 0, 0, 0 ];
    ssc.data_set_array( data, b'ffrac',  ffrac);
    ssc.data_set_number( data, b'tc_fill', 7 )
    ssc.data_set_number( data, b'tc_void', 0.25 )
    ssc.data_set_number( data, b't_dis_out_min', 500 )
    ssc.data_set_number( data, b't_ch_out_max', 500 )
    ssc.data_set_number( data, b'nodes', 2000 )
    ssc.data_set_number( data, b'f_tc_cold', 2 )
    weekday_schedule = [[ 6,   6,   6,   6,   6,   6,   5,   5,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   5,   5,   5 ], [ 3,   3,   3,   3,   3,   3,   3,   3,   2,   2,   2,   2,   1,   1,   1,   1,   1,   1,   2,   2,   2,   3,   3,   3 ], [ 3,   3,   3,   3,   3,   3,   3,   3,   2,   2,   2,   2,   1,   1,   1,   1,   1,   1,   2,   2,   2,   3,   3,   3 ], [ 3,   3,   3,   3,   3,   3,   3,   3,   2,   2,   2,   2,   1,   1,   1,   1,   1,   1,   2,   2,   2,   3,   3,   3 ], [ 3,   3,   3,   3,   3,   3,   3,   3,   2,   2,   2,   2,   1,   1,   1,   1,   1,   1,   2,   2,   2,   3,   3,   3 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   4,   5,   5,   5 ]];
    ssc.data_set_matrix( data, b'weekday_schedule', weekday_schedule );
    weekend_schedule = [[ 6,   6,   6,   6,   6,   6,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5 ], [ 3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3 ], [ 3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3 ], [ 3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3 ], [ 3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3,   3 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5 ], [ 6,   6,   6,   6,   6,   6,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5,   5 ]];
    ssc.data_set_matrix( data, b'weekend_schedule', weekend_schedule );
    ssc.data_set_number( data, b'pc_config', 0 )
    ssc.data_set_number( data, b'eta_ref', 0.35600000619888306 )
    ssc.data_set_number( data, b'startup_time', 0.5 )
    ssc.data_set_number( data, b'startup_frac', 0.20000000298023224 )
    ssc.data_set_number( data, b'q_sby_frac', 0.20000000298023224 )
    ssc.data_set_number( data, b'dT_cw_ref', 10 )
    ssc.data_set_number( data, b'T_amb_des', 42 )
    ssc.data_set_number( data, b'P_boil', 100 )
    ssc.data_set_number( data, b'CT', 2 )
    ssc.data_set_number( data, b'T_approach', 5 )
    ssc.data_set_number( data, b'T_ITD_des', 16 )
    ssc.data_set_number( data, b'P_cond_ratio', 1.0027999877929688 )
    ssc.data_set_number( data, b'pb_bd_frac', 0.019999999552965164 )
    ssc.data_set_number( data, b'P_cond_min', 1.25 )
    ssc.data_set_number( data, b'n_pl_inc', 8 )
    F_wc =[ 0, 0, 0, 0, 0, 0, 0, 0, 0 ];
    ssc.data_set_array( data, b'F_wc',  F_wc);
    ssc.data_set_number( data, b'tech_type', 2 )
    ssc.data_set_number( data, b'ud_T_amb_des', 43 )
    ssc.data_set_number( data, b'ud_f_W_dot_cool_des', 0 )
    ssc.data_set_number( data, b'ud_m_dot_water_cool_des', 0 )
    ssc.data_set_number( data, b'ud_T_htf_low', 300 )
    ssc.data_set_number( data, b'ud_T_htf_high', 410 )
    ssc.data_set_number( data, b'ud_T_amb_low', 0 )
    ssc.data_set_number( data, b'ud_T_amb_high', 55 )
    ssc.data_set_number( data, b'ud_m_dot_htf_low', 0.30000001192092896 )
    ssc.data_set_number( data, b'ud_m_dot_htf_high', 1.2000000476837158 )
    ud_T_htf_ind_od = [[ 300,   0.012391712516546249,   0.059275288134813309,   0.066524550318717957,   0.02142857201397419,   0.071428574621677399,   0.085714288055896759,   1,   1,   1,   1,   1,   1 ], [ 305.78945922851563,   0.022968079894781113,   0.10986694693565369,   0.12330347299575806,   0.039151448756456375,   0.13050483167171478,   0.1566057950258255,   1,   1,   1,   1,   1,   1 ], [ 311.57894897460938,   0.033833939582109451,   0.16184337437152863,   0.18163652718067169,   0.05687432736158371,   0.18958109617233276,   0.22749730944633484,   1,   1,   1,   1,   1,   1 ], [ 317.368408203125,   0.044982895255088806,   0.21517398953437805,   0.24148938059806824,   0.074597209692001343,   0.24865736067295074,   0.29838883876800537,   1,   1,   1,   1,   1,   1 ], [ 323.15789794921875,   0.05640876293182373,   0.26982921361923218,   0.30282881855964661,   0.092320084571838379,   0.30773362517356873,   0.36928033828735352,   1,   1,   1,   1,   1,   1 ], [ 328.94735717773438,   0.068105548620223999,   0.32578033208847046,   0.36562266945838928,   0.11004296690225601,   0.36680987477302551,   0.44017186760902405,   1,   1,   1,   1,   1,   1 ], [ 334.73684692382813,   0.080067455768585205,   0.38299968838691711,   0.42983981966972351,   0.12776584923267365,   0.42588615417480469,   0.51106339693069458,   1,   1,   1,   1,   1,   1 ], [ 340.52630615234375,   0.092288866639137268,   0.44146034121513367,   0.49545010924339294,   0.14548872411251068,   0.48496240377426147,   0.58195489645004272,   1,   1,   1,   1,   1,   1 ], [ 346.3157958984375,   0.10476434975862503,   0.50113630294799805,   0.56242436170578003,   0.16321159899234772,   0.54403865337371826,   0.65284639596939087,   1,   1,   1,   1,   1,   1 ], [ 352.10525512695313,   0.11748861521482468,   0.56200236082077026,   0.63073420524597168,   0.18093447387218475,   0.60311490297317505,   0.72373789548873901,   1,   1,   1,   1,   1,   1 ], [ 357.89474487304688,   0.13045655190944672,   0.62403404712677002,   0.7003522515296936,   0.19865736365318298,   0.66219121217727661,   0.79462945461273193,   1,   1,   1,   1,   1,   1 ], [ 363.6842041015625,   0.14366322755813599,   0.68720763921737671,   0.7712518572807312,   0.21638023853302002,   0.7212674617767334,   0.86552095413208008,   1,   1,   1,   1,   1,   1 ], [ 369.47369384765625,   0.15710379183292389,   0.75150012969970703,   0.84340715408325195,   0.23410311341285706,   0.78034371137619019,   0.93641245365142822,   1,   1,   1,   1,   1,   1 ], [ 375.26315307617188,   0.17077362537384033,   0.81688916683197021,   0.91679322719573975,   0.25182598829269409,   0.83941996097564697,   1.0073039531707764,   1,   1,   1,   1,   1,   1 ], [ 381.05264282226563,   0.1846681535243988,   0.88335317373275757,   0.99138563871383667,   0.26954886317253113,   0.89849627017974854,   1.0781954526901245,   1,   1,   1,   1,   1,   1 ], [ 386.84210205078125,   0.19878301024436951,   0.95087110996246338,   1.0671608448028564,   0.28727173805236816,   0.95757251977920532,   1.1490869522094727,   1,   1,   1,   1,   1,   1 ], [ 392.631591796875,   0.21311391890048981,   1.0194224119186401,   1.1440958976745605,   0.30499464273452759,   1.0166487693786621,   1.2199785709381104,   1,   1,   1,   1,   1,   1 ], [ 398.42105102539063,   0.22765673696994781,   1.0889874696731567,   1.2221685647964478,   0.32271751761436462,   1.0757250785827637,   1.2908700704574585,   1,   1,   1,   1,   1,   1 ], [ 404.21054077148438,   0.2424074113368988,   1.1595467329025269,   1.3013571500778198,   0.34044039249420166,   1.1348012685775757,   1.3617615699768066,   1,   1,   1,   1,   1,   1 ], [ 410,   0.25736206769943237,   1.2310817241668701,   1.3816406726837158,   0.3581632673740387,   1.1938775777816772,   1.4326530694961548,   1,   1,   1,   1,   1,   1 ]];
    ssc.data_set_matrix( data, b'ud_T_htf_ind_od', ud_T_htf_ind_od );
    ud_T_amb_ind_od = [[ 0,   0.071335971355438232,   1.1568559408187866,   1.4157259464263916,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 2.8947367668151855,   0.070495486259460449,   1.1459249258041382,   1.4028584957122803,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 5.7894735336303711,   0.069659397006034851,   1.1350511312484741,   1.3900582790374756,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 8.6842107772827148,   0.068827636539936066,   1.124233603477478,   1.3773243427276611,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 11.578947067260742,   0.068000137805938721,   1.113471508026123,   1.364655613899231,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 14.473684310913086,   0.067176833748817444,   1.1027640104293823,   1.3520511388778687,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 17.36842155456543,   0.066357657313346863,   1.0921101570129395,   1.3395099639892578,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 20.263158798217773,   0.065542556345462799,   1.0815093517303467,   1.327031135559082,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 23.157894134521484,   0.064731471240520477,   1.0709606409072876,   1.3146136999130249,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 26.052631378173828,   0.063924327492713928,   1.0604634284973145,   1.30225670337677,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 28.947368621826172,   0.063121087849140167,   1.0500167608261108,   1.2899593114852905,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 31.842105865478516,   0.062321685254573822,   1.039620041847229,   1.2777208089828491,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 34.736843109130859,   0.061526067554950714,   1.0292725563049316,   1.2655402421951294,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 37.631580352783203,   0.060734178870916367,   1.018973708152771,   1.2534167766571045,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 40.526317596435547,   0.059945970773696899,   1.0087225437164307,   1.2413495779037476,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 43.421051025390625,   0.059161391109228134,   0.99851870536804199,   1.2293380498886108,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 46.315788269042969,   0.058380391448736191,   0.98836135864257813,   1.2173812389373779,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 49.210525512695313,   0.057602923363447189,   0.97824990749359131,   1.2054784297943115,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 52.105262756347656,   0.05682893842458725,   0.96818381547927856,   1.1936290264129639,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ], [ 55,   0.056058388203382492,   0.95816236734390259,   1.1818321943283081,   0.071428574621677399,   1,   1.1938775777816772,   1,   1,   1,   1,   1,   1 ]];
    ssc.data_set_matrix( data, b'ud_T_amb_ind_od', ud_T_amb_ind_od );
    ud_m_dot_htf_ind_od = [[ 0.30000001192092896,   0.24184487760066986,   0.20905359089374542,   0.20030727982521057,   0.30000001192092896,   0.30000001192092896,   0.30000001192092896,   1,   1,   1,   1,   1,   1 ], [ 0.34736841917037964,   0.29262182116508484,   0.25294578075408936,   0.24236312508583069,   0.34736841917037964,   0.34736841917037964,   0.34736841917037964,   1,   1,   1,   1,   1,   1 ], [ 0.39473685622215271,   0.34552481770515442,   0.29867574572563171,   0.28617987036705017,   0.39473685622215271,   0.39473685622215271,   0.39473685622215271,   1,   1,   1,   1,   1,   1 ], [ 0.44210526347160339,   0.40037104487419128,   0.34608548879623413,   0.33160609006881714,   0.44210526347160339,   0.44210526347160339,   0.44210526347160339,   1,   1,   1,   1,   1,   1 ], [ 0.48947367072105408,   0.45701181888580322,   0.39504644274711609,   0.37851864099502563,   0.48947367072105408,   0.48947367072105408,   0.48947367072105408,   1,   1,   1,   1,   1,   1 ], [ 0.53684210777282715,   0.51532334089279175,   0.44545161724090576,   0.4268149733543396,   0.53684210777282715,   0.53684210777282715,   0.53684210777282715,   1,   1,   1,   1,   1,   1 ], [ 0.58421051502227783,   0.57520079612731934,   0.49721038341522217,   0.47640827298164368,   0.58421051502227783,   0.58421051502227783,   0.58421051502227783,   1,   1,   1,   1,   1,   1 ], [ 0.63157892227172852,   0.63655394315719604,   0.55024480819702148,   0.52722382545471191,   0.63157892227172852,   0.63157892227172852,   0.63157892227172852,   1,   1,   1,   1,   1,   1 ], [ 0.67894738912582397,   0.69930434226989746,   0.60448694229125977,   0.57919669151306152,   0.67894738912582397,   0.67894738912582397,   0.67894738912582397,   1,   1,   1,   1,   1,   1 ], [ 0.72631579637527466,   0.76338285207748413,   0.6598772406578064,   0.63226950168609619,   0.72631579637527466,   0.72631579637527466,   0.72631579637527466,   1,   1,   1,   1,   1,   1 ], [ 0.77368420362472534,   0.82872819900512695,   0.71636253595352173,   0.68639159202575684,   0.77368420362472534,   0.77368420362472534,   0.77368420362472534,   1,   1,   1,   1,   1,   1 ], [ 0.82105261087417603,   0.89528554677963257,   0.77389544248580933,   0.74151748418807983,   0.82105261087417603,   0.82105261087417603,   0.82105261087417603,   1,   1,   1,   1,   1,   1 ], [ 0.86842107772827148,   0.96300536394119263,   0.83243328332901001,   0.79760628938674927,   0.86842107772827148,   0.86842107772827148,   0.86842107772827148,   1,   1,   1,   1,   1,   1 ], [ 0.91578948497772217,   1.0318429470062256,   0.89193731546401978,   0.85462081432342529,   0.91578948497772217,   0.91578948497772217,   0.91578948497772217,   1,   1,   1,   1,   1,   1 ], [ 0.96315789222717285,   1.1017575263977051,   0.95237225294113159,   0.91252726316452026,   0.96315789222717285,   0.96315789222717285,   0.96315789222717285,   1,   1,   1,   1,   1,   1 ], [ 1.0105262994766235,   1.1653280258178711,   1.0073233842849731,   0.96517932415008545,   1.0105262994766235,   1.0105262994766235,   1.0105262994766235,   1,   1,   1,   1,   1,   1 ], [ 1.0578947067260742,   1.2021303176879883,   1.0391356945037842,   0.99566078186035156,   1.0578947067260742,   1.0578947067260742,   1.0578947067260742,   1,   1,   1,   1,   1,   1 ], [ 1.1052631139755249,   1.2366691827774048,   1.0689915418624878,   1.0242675542831421,   1.1052631139755249,   1.1052631139755249,   1.1052631139755249,   1,   1,   1,   1,   1,   1 ], [ 1.1526315212249756,   1.2687950134277344,   1.0967614650726318,   1.0508755445480347,   1.1526315212249756,   1.1526315212249756,   1.1526315212249756,   1,   1,   1,   1,   1,   1 ], [ 1.2000000476837158,   1.2983372211456299,   1.1222981214523315,   1.0753438472747803,   1.2000000476837158,   1.2000000476837158,   1.2000000476837158,   1,   1,   1,   1,   1,   1 ]];
    ssc.data_set_matrix( data, b'ud_m_dot_htf_ind_od', ud_m_dot_htf_ind_od );
    ssc.data_set_number( data, b'eta_lhv', 0.89999997615814209 )
    ssc.data_set_number( data, b'eta_tes_htr', 0.98000001907348633 )
    ssc.data_set_number( data, b'adjust:constant', 4 )
    module = ssc.module_create(b'tcstrough_physical')	
    ssc.module_exec_set_print( 0 );
    if ssc.module_exec(module, data) == 0:
    	print ('tcstrough_physical simulation error')
    	idx = 1
    	msg = ssc.module_log(module, 0)
    	while (msg != None):
    		print ('	: ' + msg.decode("utf - 8"))
    		msg = ssc.module_log(module, idx)
    		idx = idx + 1
    	SystemExit( "Simulation Error" );
    ssc.module_free(module)
    ssc.data_set_number( data, b'capital_cost', 303250240 )
    ssc.data_set_number( data, b'fixed_operating_cost', 3300002.5 )
    ssc.data_set_number( data, b'variable_operating_cost', 0.0040000001899898052 )
    ssc.data_set_number( data, b'fixed_charge_rate', 0.097505807876586914 )
    module = ssc.module_create(b'lcoefcr')	
    ssc.module_exec_set_print( 0 );
    if ssc.module_exec(module, data) == 0:
    	print ('lcoefcr simulation error')
    	idx = 1
    	msg = ssc.module_log(module, 0)
    	while (msg != None):
    		print ('	: ' + msg.decode("utf - 8"))
    		msg = ssc.module_log(module, idx)
    		idx = idx + 1
    	SystemExit( "Simulation Error" );
    ssc.module_free(module)
    annual_energy = ssc.data_get_number(data, b'annual_energy');
    print ('Annual energy (year 1) = ', annual_energy)
    conversion_factor = ssc.data_get_number(data, b'conversion_factor');
    print ('Gross-to-net conversion = ', conversion_factor)
    def data_free(self):
        self.ssc.data_free(self.data);